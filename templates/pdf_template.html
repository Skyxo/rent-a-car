<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProcÃ¨s-Verbal de MatÃ©riel LouÃ©</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.4;
            color: #000;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid #001632;
            padding-bottom: 15px;
        }
        
        .logo {
            max-width: 250px;
            height: auto;
            margin-bottom: 10px;
        }
        
        h1 {
            color: #001632;
            font-size: 18pt;
            margin-top: 10px;
        }
        
        h2 {
            color: #CB1F1F;
            font-size: 12pt;
            margin: 15px 0 10px 0;
            border-bottom: 2px solid #CB1F1F;
            padding-bottom: 3px;
        }
        
        .info-section {
            margin-bottom: 15px;
        }
        
        .info-row {
            display: flex;
            margin-bottom: 5px;
        }
        
        .info-label {
            font-weight: bold;
            width: 150px;
            color: #001632;
        }
        
        .info-value {
            flex: 1;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 9pt;
        }
        
        th {
            background-color: #001632;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #001632;
        }
        
        td {
            padding: 6px 8px;
            border: 1px solid #333;
        }
        
        .status-bon {
            color: #28a745;
            font-weight: bold;
        }
        
        .status-defectueux {
            color: #dc3545;
            font-weight: bold;
        }
        
        .status-empty {
            color: #999;
        }
        
        .signature-section {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
        }
        
        .signature-box {
            width: 48%;
            border: 2px solid #001632;
            padding: 10px;
            min-height: 120px;
        }
        
        .signature-title {
            font-weight: bold;
            color: #CB1F1F;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .signature-img {
            max-width: 100%;
            max-height: 100px;
            display: block;
            margin: 0 auto;
        }
        
        .footer {
            margin-top: 20px;
            text-align: center;
            font-size: 8pt;
            color: #666;
            border-top: 1px solid #ccc;
            padding-top: 10px;
        }
        
        .dates-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .photos-section {
            margin-top: 15px;
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        
        .photos-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .photo-item {
            width: calc(33% - 7px);
            border: 1px solid #ddd;
            padding: 5px;
            text-align: center;
        }
        
        .photo-item img {
            max-width: 100%;
            max-height: 150px;
            height: auto;
            display: block;
            margin: 0 auto 5px auto;
        }
        
        .photo-label {
            font-size: 8pt;
            color: #666;
            font-weight: bold;
        }
        
        .date-box {
            width: 48%;
            border: 1px solid #001632;
            padding: 10px;
            background-color: #f8f9fa;
        }
        
        .date-box h3 {
            color: #CB1F1F;
            font-size: 11pt;
            margin-bottom: 8px;
        }
        
        .alert-fuite {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            padding: 5px;
            margin: 5px 0;
            color: #856404;
            font-weight: bold;
        }
        
        .observations-box {
            border: 1px solid #001632;
            padding: 10px;
            margin: 10px 0;
            min-height: 60px;
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <!-- En-tÃªte -->
    <div class="header">
        <img src="https://www.centralelyonconseil.fr/wp-content/uploads/2023/10/logo_horizontal_avectexte.png" 
             alt="Centrale Lyon Conseil" 
             class="logo">
        <h1>PROCÃˆS-VERBAL DE MATÃ‰RIEL LOUÃ‰</h1>
    </div>

    <!-- Informations GÃ©nÃ©rales -->
    <div class="info-section">
        <h2>Identification du MatÃ©riel</h2>
        <div class="info-row">
            <div class="info-label">Chantier :</div>
            <div class="info-value">{{ chantier }}</div>
        </div>
        <div class="info-row">
            <div class="info-label">MatÃ©riel / NÂ° :</div>
            <div class="info-value">{{ materiel_numero }}</div>
        </div>
        <div class="info-row">
            <div class="info-label">Type :</div>
            <div class="info-value">{{ materiel_type }}</div>
        </div>
        <div class="info-row">
            <div class="info-label">Fournisseur :</div>
            <div class="info-value">{{ fournisseur }}</div>
        </div>
        <div class="info-row">
            <div class="info-label">Responsable Chantier :</div>
            <div class="info-value">{{ responsable }}</div>
        </div>
    </div>

    <!-- Dates et Compteurs -->
    <div class="dates-section">
        <div class="date-box">
            <h3>RÃ‰CEPTION</h3>
            <div class="info-row">
                <div class="info-label">Date :</div>
                <div class="info-value">{{ date_reception or 'Non renseignÃ©' }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">Compteur :</div>
                <div class="info-value">{{ compteur_reception or 'N/A' }} h</div>
            </div>
        </div>
        
        <div class="date-box">
            <h3>RETOUR</h3>
            <div class="info-row">
                <div class="info-label">Date :</div>
                <div class="info-value">{{ date_retour or 'Non renseignÃ©' }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">Compteur :</div>
                <div class="info-value">{{ compteur_retour or 'N/A' }} h</div>
            </div>
        </div>
    </div>

    <!-- Inspection - Aspect ExtÃ©rieur -->
    <h2>Inspection - Aspect ExtÃ©rieur</h2>
    <table>
        <thead>
            <tr>
                <th style="width: 40%;">Ã‰lÃ©ment</th>
                <th style="width: 30%; text-align: center;">RÃ©ception</th>
                <th style="width: 30%; text-align: center;">Retour</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Carrosserie / RÃ©troviseurs</td>
                <td style="text-align: center;">
                    {% if carrosserie_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif carrosserie_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if carrosserie_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif carrosserie_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Ã‰clairage / Gyrophare</td>
                <td style="text-align: center;">
                    {% if eclairage_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif eclairage_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if eclairage_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif eclairage_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Pneumatiques</td>
                <td style="text-align: center;">
                    {% if pneumatiques_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif pneumatiques_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if pneumatiques_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif pneumatiques_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Panier (si applicable)</td>
                <td style="text-align: center;">
                    {% if panier_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif panier_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if panier_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif panier_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Flexibles, faisceaux Ã©lectrique</td>
                <td style="text-align: center;">
                    {% if flexibles_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif flexibles_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if flexibles_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif flexibles_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Commandes</td>
                <td style="text-align: center;">
                    {% if commandes_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif commandes_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if commandes_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif commandes_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Photos - Aspect ExtÃ©rieur -->
    {% if photo_carrosserie or photo_eclairage or photo_pneumatiques or photo_panier or photo_flexibles or photo_commandes %}
    <div class="photos-section">
        <h3 style="color: #001632; font-size: 10pt; margin-bottom: 8px;">ðŸ“· Photos - Aspect ExtÃ©rieur</h3>
        <div class="photos-grid">
            {% if photo_carrosserie %}
            <div class="photo-item">
                <img src="{{ photo_carrosserie }}" alt="Carrosserie">
                <div class="photo-label">Carrosserie / RÃ©troviseurs</div>
            </div>
            {% endif %}
            
            {% if photo_eclairage %}
            <div class="photo-item">
                <img src="{{ photo_eclairage }}" alt="Ã‰clairage">
                <div class="photo-label">Ã‰clairage / Gyrophare</div>
            </div>
            {% endif %}
            
            {% if photo_pneumatiques %}
            <div class="photo-item">
                <img src="{{ photo_pneumatiques }}" alt="Pneumatiques">
                <div class="photo-label">Pneumatiques</div>
            </div>
            {% endif %}
            
            {% if photo_panier %}
            <div class="photo-item">
                <img src="{{ photo_panier }}" alt="Panier">
                <div class="photo-label">Panier</div>
            </div>
            {% endif %}
            
            {% if photo_flexibles %}
            <div class="photo-item">
                <img src="{{ photo_flexibles }}" alt="Flexibles">
                <div class="photo-label">Flexibles / Faisceaux</div>
            </div>
            {% endif %}
            
            {% if photo_commandes %}
            <div class="photo-item">
                <img src="{{ photo_commandes }}" alt="Commandes">
                <div class="photo-label">Commandes</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Inspection - Fonctionnement -->
    <h2>Inspection - Fonctionnement</h2>
    <table>
        <thead>
            <tr>
                <th style="width: 40%;">Ã‰lÃ©ment</th>
                <th style="width: 30%; text-align: center;">RÃ©ception</th>
                <th style="width: 30%; text-align: center;">Retour</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ConformitÃ© rÃ©glementaire</td>
                <td style="text-align: center;">
                    {% if conformite_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif conformite_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if conformite_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif conformite_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Essais de mobilitÃ©s</td>
                <td style="text-align: center;">
                    {% if mobilites_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif mobilites_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if mobilites_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif mobilites_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Essais de nacelles</td>
                <td style="text-align: center;">
                    {% if nacelles_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif nacelles_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if nacelles_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif nacelles_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
            
            <tr>
                <td>Dispositifs de sÃ©curitÃ©</td>
                <td style="text-align: center;">
                    {% if securite_reception == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif securite_reception == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if securite_retour == 'bon' %}
                        <span class="status-bon">âœ“ BON</span>
                    {% elif securite_retour == 'defectueux' %}
                        <span class="status-defectueux">âœ— DÃ‰FECTUEUX</span>
                    {% else %}
                        <span class="status-empty">-</span>
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Photos - Fonctionnement -->
    {% if photo_conformite or photo_mobilites or photo_nacelles or photo_securite %}
    <div class="photos-section">
        <h3 style="color: #001632; font-size: 10pt; margin-bottom: 8px;">ðŸ“· Photos - Fonctionnement</h3>
        <div class="photos-grid">
            {% if photo_conformite %}
            <div class="photo-item">
                <img src="{{ photo_conformite }}" alt="ConformitÃ©">
                <div class="photo-label">ConformitÃ© rÃ©glementaire</div>
            </div>
            {% endif %}
            
            {% if photo_mobilites %}
            <div class="photo-item">
                <img src="{{ photo_mobilites }}" alt="MobilitÃ©s">
                <div class="photo-label">Essais de mobilitÃ©s</div>
            </div>
            {% endif %}
            
            {% if photo_nacelles %}
            <div class="photo-item">
                <img src="{{ photo_nacelles }}" alt="Nacelles">
                <div class="photo-label">Essais de nacelles</div>
            </div>
            {% endif %}
            
            {% if photo_securite %}
            <div class="photo-item">
                <img src="{{ photo_securite }}" alt="SÃ©curitÃ©">
                <div class="photo-label">Dispositifs de sÃ©curitÃ©</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Fluides -->
    <h2>Fluides</h2>
    <table>
        <thead>
            <tr>
                <th style="width: 40%;">Type</th>
                <th style="width: 30%; text-align: center;">RÃ©ception</th>
                <th style="width: 30%; text-align: center;">Retour</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Niveau Carburant</td>
                <td style="text-align: center;">{{ carburant_reception or '-' }}</td>
                <td style="text-align: center;">{{ carburant_retour or '-' }}</td>
            </tr>
            <tr>
                <td>Fuites Moteur</td>
                <td style="text-align: center;">
                    {% if fuite_moteur_reception == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if fuite_moteur_retour == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>Fuites Hydraulique</td>
                <td style="text-align: center;">
                    {% if fuite_hydraulique_reception == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if fuite_hydraulique_retour == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>Fuites Gasoil</td>
                <td style="text-align: center;">
                    {% if fuite_gasoil_reception == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {% if fuite_gasoil_retour == 'oui' %}
                        <span class="status-defectueux">âš  OUI</span>
                    {% else %}
                        <span class="status-bon">NON</span>
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Photos - Fuites -->
    {% if photo_fuite_reception or photo_fuite_retour %}
    <div class="photos-section">
        <h3 style="color: #001632; font-size: 10pt; margin-bottom: 8px;">ðŸ“· Photos - Fuites</h3>
        <div class="photos-grid">
            {% if photo_fuite_reception %}
            <div class="photo-item">
                <img src="{{ photo_fuite_reception }}" alt="Fuites RÃ©ception">
                <div class="photo-label">Fuites - RÃ©ception</div>
            </div>
            {% endif %}
            
            {% if photo_fuite_retour %}
            <div class="photo-item">
                <img src="{{ photo_fuite_retour }}" alt="Fuites Retour">
                <div class="photo-label">Fuites - Retour</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Observations -->
    <h2>Observations</h2>
    <div class="dates-section">
        <div class="observations-box" style="width: 48%;">
            <strong>RÃ©ception :</strong><br>
            {{ observations_reception or 'Aucune observation' }}
        </div>
        <div class="observations-box" style="width: 48%;">
            <strong>Retour :</strong><br>
            {{ observations_retour or 'Aucune observation' }}
        </div>
    </div>

    <!-- Photos - Observations -->
    {% if photo_observation_reception or photo_observation_retour %}
    <div class="photos-section">
        <h3 style="color: #001632; font-size: 10pt; margin-bottom: 8px;">ðŸ“· Photos - Observations</h3>
        <div class="photos-grid">
            {% if photo_observation_reception %}
            <div class="photo-item">
                <img src="{{ photo_observation_reception }}" alt="Observations RÃ©ception">
                <div class="photo-label">Observations - RÃ©ception</div>
            </div>
            {% endif %}
            
            {% if photo_observation_retour %}
            <div class="photo-item">
                <img src="{{ photo_observation_retour }}" alt="Observations Retour">
                <div class="photo-label">Observations - Retour</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Signatures -->
    <div class="signature-section">
        <div class="signature-box">
            <div class="signature-title">VISA RÃ‰CEPTION</div>
            {% if signature_reception %}
                <img src="{{ signature_reception }}" alt="Signature RÃ©ception" class="signature-img">
            {% else %}
                <p style="text-align: center; color: #999; margin-top: 30px;">Non signÃ©e</p>
            {% endif %}
        </div>
        
        <div class="signature-box">
            <div class="signature-title">VISA RETOUR</div>
            {% if signature_retour %}
                <img src="{{ signature_retour }}" alt="Signature Retour" class="signature-img">
            {% else %}
                <p style="text-align: center; color: #999; margin-top: 30px;">Non signÃ©e</p>
            {% endif %}
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>Document gÃ©nÃ©rÃ© automatiquement le {{ date_generation }}</p>
        <p>Centrale Lyon Conseil - Ã‰cole Centrale de Lyon</p>
    </div>
</body>
</html>
